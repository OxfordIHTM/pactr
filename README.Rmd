---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# pactr: An Interface to the Pandemic PACT Data Repository <img src='man/figures/logo.png' width='200px' align='right' />

<!-- badges: start -->
[![Project Status: WIP â€“ Initial development is in progress, but there has not yet been a stable, usable release suitable for the public.](https://www.repostatus.org/badges/latest/wip.svg)](https://www.repostatus.org/#wip)
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
[![R-CMD-check](https://github.com/OxfordIHTM/pactr/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/OxfordIHTM/pactr/actions/workflows/R-CMD-check.yaml)
[![test-coverage.yaml](https://github.com/OxfordIHTM/pactr/actions/workflows/test-coverage.yaml/badge.svg)](https://github.com/OxfordIHTM/pactr/actions/workflows/test-coverage.yaml)
[![Codecov test coverage](https://codecov.io/gh/OxfordIHTM/pactr/branch/main/graph/badge.svg)](https://app.codecov.io/gh/OxfordIHTM/pactr?branch=main)
[![CodeFactor](https://www.codefactor.io/repository/github/OxfordIHTM/pactr/badge)](https://www.codefactor.io/repository/github/OxfordIHTM/pactr)
<!-- badges: end -->

The [Pandemic PACT](https://www.pandemicpact.org/) monitors and analyses global funding and research evidence related to diseases with pandemic potential, as well as broader research preparedness efforts, and is equipped to pivot in response to outbreaks. It collects, curates, codes, and analyses data in alignment with WHO priority diseases and other selected illnesses, including pandemic influenza, mpox, and plague. Pandemic PACT aims to guide policy and decision-making for research funders, policymakers, researchers, multilateral agencies. The database is publicly available for download from its website and from [Figshare](https://portal.sds.ox.ac.uk/pandemicpact). This package interfaces with the project's [Figshare](https://portal.sds.ox.ac.uk/pandemicpact) repository to provide programmatic access to its publicly available tracker data along with other data products provided by the project.

## What does `pactr` do?

`pactr` provides functions to interface with Pandemic PACT's [Figshare](https://portal.sds.ox.ac.uk/pandemicpact) repository for programmatic access to its contents. These functions are wrappers to specific functions of the [`deposits` package](https://docs.ropensci.org/deposits/index.html) which provides the underlying universal interface to various online research data deposition services including Figshare. Current functionalities available in `pactr` are:

1. Lists outputs/assets available from the Panedmic PACT Figshare repository;

2. Downloads outputs/assets available from the Pandemic PACT Figshare repository; and,

3. Reads dataset outputs/assets available from the Pandemic PACT Figshare repository.

## Installation

`pactr` is not yet on CRAN but can be installed through the [Oxford IHTM r-universe](https://oxfordihtm.r-universe.dev) with:

```R
install.packages(
  "pactr",
  repos = c("https://oxfordihtm.r-universe.dev", "https://cloud.r-project.org")
)
```

Alternatively, `pactr` can be installed directly from [GitHub](https://github.com/OxfordIHTM/pactr) with the following command:

```R
if (!requireNamespace("remotes")) install.packages("remotes")
remotes::install_github("OxfordIHTM/pactr")
```

`pactr` can then be loaded for use with:

```{r load-package}
library(pactr)
```

## Usage

### 1. List outputs/assets

To list available outputs/assets from the Pandemic PACT Figshare repository, issue the following command:

```{r usage-1a, eval = FALSE}
pact_list()
```

The output is a `data.frame` containing metadata regarding contents of the Figshare Pandemic PACT group. The information within the metadata are those provided by [Figshare's application programming interface (API)](https://docs.figshare.com/) and are either set by the Pandemic PACT data team or by Figshare. The data.frame would have the following fields:

```{r usage-1b, echo = FALSE}
pact_list() |>
  names()
```

This function is useful in getting an overview of what is currently available in the Pandemic PACT Figshare repository.

### 2. Download outputs/assets

To download a specific output/asset - say the scoping review data - from the Pandemic PACT Figshare repository, issue the following commands:

```{r usage-2a, eval = FALSE}
## Get the unique identifier for the scoping review data from Figshare ----
file_id <- pact_list() |>
  subset(title == "Scoping Review Data", select = id) |>
  unlist()

pact_download(id = file_id, path = ".")
```

This will download the file `Scoping_Review-Data.xlsx` from the Pandemic PACT Figshare repository into the current working directory.

### 3. Read the Pandemic PACT tracker dataset and data dictionary

To read the Pandemic PACT tracker dataset into R, issue the following command:

```{r usage-3a, eval = FALSE}
pact_read_data_tracker()
```

which outputs the following:

```{r usage-3b, echo = FALSE}
pact_read_data_tracker() |>
  head()
```

This reads the *labelled* tracker dataset by default. If the raw dataset is required, then issue the following command:

```{r usage-3c, eval = FALSE}
pact_read_data_tracker(tracker_type = "raw")
```

which outputs the following:

```{r usage-3d, echo = FALSE}
pact_read_data_tracker(tracker_type = "raw") |>
  head()
```

## Citation

To cite the `pactr` package, please use the suggested citation provided by a call to the `citation()` function as follows:

```{r citation-package}
citation("pactr")
```

To cite the Pandemic PACT Tracker dataset, please use the suggested citation provided by a call to the `pact_cite()` function as follows:

```{r citation-data}
pact_cite(id = 24763548)
```

## Community guidelines

Feedback, bug reports and feature requests are welcome; file issues or seek support [here](https://github.com/OxfordIHTM/pactr/issues). If you would like to contribute to the package, please see our [contributing guidelines](https://oxford-ihtm.io/pactr/CONTRIBUTING.html).

This project is released with a [Contributor Code of Conduct](https://oxford-ihtm/pactr/CODE_OF_CONDUCT.html). By participating in this project you agree to abide by its terms.
